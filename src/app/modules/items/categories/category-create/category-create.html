<ng-template #headerContent>
  <div class="w-full flex items-center justify-between">
    <p-button icon="pi pi-times" (click)="close.emit()" variant="text"></p-button>
    <span class="font-bold text-center text-2xl flex-1">Yangi kategoriya qo'shish</span>
    <p-button icon="pi pi-check" label="Saqlash" (click)="onSubmit()"></p-button>
  </div>
</ng-template>

<div class="flex justify-center items-start min-h-screen pt-6">
  <p-card class="w-full max-w-4xl shadow-md rounded-lg" header="Yangi kategoriya qo'shish"
          [style]="{'box-shadow': 'none', 'background-color': 'transparent'}">
    <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()" class="space-y-4">
      <!-- Category Code -->
      <div>
        <p-floatlabel variant="in">
          <input pInputText id="in_label" formControlName="code" autocomplete="off" class="w-full"/>
          <label for="in_label">Kategoriya kalit so'zi</label>
        </p-floatlabel>
      </div>

      <!-- file uploader -->
      <div>
        <p-floatlabel  variant="in">
          <p-select
            [options]="parentCategories"
            optionLabel="name"
            optionValue="id"
            formControlName="parentId"
            class="w-full"
          ></p-select>
          <label>Gurux kategoriya</label>
        </p-floatlabel>
      </div>


      <!-- Translations -->
      <div formArrayName="translations" class="space-y-4">
        @for (t of translations.controls; track $index) {
          <div [formGroupName]="$index" class="border rounded p-4 bg-white dark:bg-slate-800 shadow">
            <div class="flex flex-col md:flex-row md:items-end md:gap-4">

              <!-- Language Code -->
              <div class="flex flex-col flex-1">
                <label class="font-medium text-sm">Tarjima kodi (uz, ru ...)</label>
                <input
                  pInputText
                  type="text"
                  formControlName="languageCode"
                  placeholder="en"
                  class="w-full"
                />
              </div>

              <!-- Name -->
              <div class="flex flex-col flex-1">
                <label class="font-medium text-sm">Kategoriya nomi</label>
                <input
                  pInputText
                  type="text"
                  formControlName="name"
                  placeholder="Santexnika, Elektronika..."
                  class="w-full"
                />
              </div>

              <!-- Description -->
              <div class="flex flex-col flex-1">
                <label class="font-medium text-sm">Izox</label>
                <input
                  pInputText
                  type="text"
                  formControlName="description"
                  placeholder="Qurilish yo'nalishidagi..."
                  class="w-full"
                />
              </div>

              <!-- Remove Button -->
              <div class="flex justify-end mt-2 md:mt-0">
                <p-button
                  type="button"
                  icon="pi pi-trash"
                  severity="danger"
                  (click)="removeTranslation($index)"
                ></p-button>
              </div>

            </div>
          </div>
        }
      </div>

      <!-- Add Translation Button -->
      <div class="flex justify-start">
        <p-button
          type="button"
          label="Yangi tarjima"
          icon="pi pi-plus"
          class="p-button-outlined"
          (click)="addTranslation()"
        ></p-button>
      </div>
    </form>
  </p-card>
</div>
