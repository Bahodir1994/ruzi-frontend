<p-card class="card">
  <ng-template #header>
    <p class="text-3xl font-bold px-4 pt-2">O'lchov birligi</p>
    @if (unitModel.length > 0) {
      <div class="flex w-full justify-between gap-2 p-4">
        <p-icon-field iconPosition="right" class="pr-2">
          <p-inputicon class="pi pi-search"></p-inputicon>
          <input
            type="text"
            pInputText
            placeholder="Qidiruv"
            [(ngModel)]="searchValue"
            (input)="loadData()"
          />
        </p-icon-field>
        <p-button
          *kaHasRoles="['ROLE_UNIT_CREATE']"
          class="pr-2"
          styleClass="shadow shadow-blue-500/50"
          icon="pi pi-file-plus"
          label="Yangi o'lchov birligi qo'shish"
          (click)="showModalUnit = true"
        />
      </div>
    }
  </ng-template>

  @if (unitModel.length === 0) {
    <div
      class="relative flex flex-col items-center justify-center border rounded px-20 py-28 text-center transition-all duration-200 mt-0"
    >
      <img ngSrc="assets/images/icons/compass.png" width="200" height="200" alt="icon"/>
      <p class="text-2xl font-bold">
        O‘lchov birligi
      </p>
      <span class="text-sm max-w-2xl">
        Tovarlarning miqdorini to‘g‘ri belgilash, sotuv jarayonida miqdor hisobini yuritish va hisobotlarda aniq ko‘rsatkichlarni shakllantirishga yordam beradi. Dona, kilogramm, litr, metr kabi o‘lchov birliklarini yaratishingiz va boshqarishingiz mumkin.
      </span>
      <p-button
        *kaHasRoles="['ROLE_UNIT_CREATE']"
        class="p-2"
        styleClass="shadow shadow-blue-500/50"
        icon="pi pi-file-plus"
        label="Yangi o'lchov birligi qo'shish"
        (onClick)="openDialog()"
      />
    </div>
  } @else {
    <p-table
      size="small"
      #dataTableUnit
      [value]="unitModel"
      dataKey="id"
      [rowHover]="true"
      [rows]="10"
      [showCurrentPageReport]="true"
      [rowsPerPageOptions]="[10, 25, 50]"
      loadingIcon="pi pi-spinner"
      [paginator]="true"
      currentPageReportTemplate="{totalPages} ta dan {currentPage}-saxifa, jami {totalRecords} ta dan {first}-{last} gacha"
      [filterDelay]="0"
      [scrollable]="true"
      [totalRecords]="totalRecords"
      [lazy]="true"
      (onLazyLoad)="pageChange($event)"
      [first]="0"
      [pageLinks]="5"
      [showJumpToPageInput]="true"
      scrollHeight="80vh"
    >
      <ng-template pTemplate="header">
        <tr class="border shadow h-[60px]">
          <th pSortableColumn="code" class="text-center text-nowrap sort-header">
            Kodi
            <p-sortIcon field="skuCode"/>
          </th>
          <th pSortableColumn="name" class="text-center text-nowrap sort-header">
            Nomi
            <p-sortIcon field="name"/>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body"
                   let-row
                   let-i="rowIndex"
      >
        <tr style="height:49px">
          <td class="text-nowrap text-center">{{ row.code }}</td>
          <td class="text-nowrap text-center">{{ row.name }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td [attr.colspan]="12 " class="mx-auto">
            <div class="flex flex-col items-center justify-center p-6 text-gray-500">
              <i class="pi pi-info-circle text-3xl mb-2"></i>
              <span>Mahsulotlar topilmadi</span>
            </div>
          </td>
        </tr>
      </ng-template>

    </p-table>
  }
</p-card>

<p-dialog
  [(visible)]="showModalUnit"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [closable]="true"
  [maximizable]="true"
  [dismissableMask]="true"
  [style]="{ minWidth: '50rem'}"
  #dialog
  [baseZIndex]="10000"
  (onHide)="resetUnitDialog()"
>
  <div class="grid grid-flow-col grid-rows-2 gap-4 text-center">
    <p class="text-xl">Taqiq</p>
    <p class="text-red-600">Bu bo'lim vaqtincha yopilgan, qo'shimcha birliklar qo'shish uchun administratorga murojaat
      qiling</p>
  </div>
</p-dialog>
